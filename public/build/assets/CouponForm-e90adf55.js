import{m as o,f as e,g as t,_ as a,h as s,o as l,z as c,w as d,v as n,t as i,q as u,i as p,F as h,j as r}from"./app-5a177a8d.js";const C=a({props:{shopId:{type:Number,required:!1,default:null},forCheckout:{type:Boolean,default:!1}},data:()=>({couponCode:null,couponLoading:!1}),computed:{...o("cart",["getCouponCode","getSelectedCartIds","getSelectedCartIdsByShopId"]),...o("auth",["isAuthenticated"])},methods:{...e("cart",["saveCoupon","resetCoupon"]),...t("auth",["showLoginDialog"]),async applyCoupon(){if(this.isAuthenticated){if(!this.couponCode)return;this.couponLoading=!0;let o={coupon_code:this.couponCode,shop_id:this.shopId,cart_item_ids:this.shopId?this.getSelectedCartIdsByShopId(this.shopId):this.getSelectedCartIds};const e=await this.call_api("post","checkout/coupon/apply",o);console.log(e),e.data.success?(this.snack({message:e.data.message}),this.saveCoupon({shopId:this.shopId,couponCode:this.couponCode,couponDetails:e.data.coupon_details})):this.snack({message:e.data.message,color:"red"}),this.couponLoading=!1}else this.showLoginDialog(!0)},removeCoupon(){this.couponCode=null,this.resetCoupon(this.shopId)}}},[["render",function(o,e,t,a,C,f){const g=s("v-col"),m=s("v-text-field"),k=s("v-btn"),y=s("v-row");return l(),c(y,{class:"mt-0",dense:!t.forCheckout,align:"center"},{default:d(()=>[t.forCheckout?u("",!0):(l(),c(g,{key:0,cols:"auto",class:"fs-13 fw-600 opacity-50 flex-shrink-0"},{default:d(()=>[n(i(o.$t("have_a_code")),1)]),_:1})),null!=o.getCouponCode(t.shopId)?(l(),p(h,{key:1},[r(g,{cols:t.forCheckout?8:null,class:"fw-500 opacity-80"},{default:d(()=>[r(m,{placeholder:o.$t("coupon_code"),class:"text-field form-control form-control-sm white grey lighten-4",type:"text",value:o.getCouponCode(t.shopId),"hide-details":"auto",required:"",variant:"plain",disabled:""},null,8,["placeholder","value"])]),_:1},8,["cols"]),r(g,{cols:t.forCheckout?4:"auto",class:"fw-700"},{default:d(()=>[r(k,{elevation:"0",color:"grey",class:"white-text darken-3 text-capitalize px-5",small:"",onClick:f.removeCoupon},{default:d(()=>[n(i(o.$t("change")),1)]),_:1},8,["onClick"])]),_:1},8,["cols"])],64)):(l(),p(h,{key:2},[r(g,{cols:t.forCheckout?8:null,class:"fw-500 opacity-80"},{default:d(()=>[r(m,{placeholder:o.$t("coupon_code"),class:"text-field form-control form-control-sm white",type:"text",modelValue:o.couponCode,"onUpdate:modelValue":e[0]||(e[0]=e=>o.couponCode=e),"hide-details":"auto",required:"",variant:"plain"},null,8,["placeholder","modelValue"])]),_:1},8,["cols"]),r(g,{cols:t.forCheckout?4:"auto",class:"fw-700"},{default:d(()=>[r(k,{elevation:"0",color:"grey",class:"white-text darken-3 text-capitalize px-5",small:"",onClick:f.applyCoupon,loading:o.couponLoading,disabled:o.couponLoading},{default:d(()=>[n(i(o.$t("apply")),1)]),_:1},8,["onClick","loading","disabled"])]),_:1},8,["cols"])],64))]),_:1},8,["dense"])}]]);export{C};
