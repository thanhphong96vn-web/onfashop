import{_ as b,f as C,g as $,h as u,o as g,i as m,k as o,t as l,j as r,w as s,q as w,s as f}from"./app-f730b58b.js";const P={data:()=>({loading:!0,currentPage:1,totalPages:1,orders:[],selectedOrder:{}}),computed:{headers(){return[{title:this.$i18n.t("details"),align:"start",sortable:!1,value:"details"},{title:this.$i18n.t("info"),sortable:!1,value:"info"},{title:this.$i18n.t("amount"),sortable:!1,value:"grand_total"},{title:this.$i18n.t("actions"),sortable:!1,align:"center",value:"actions"}]}},watch:{currentPage(){this.$router.push({query:{...this.$route.query,page:this.currentPage}}).catch(()=>{})}},methods:{...C("cart",["addToCart"]),...$("auth",["updateCartDrawer"]),getProductsCount(t){let e=0;return t.orders.forEach(n=>{e+=n.products.data.length}),e},async getList(){this.loading=!0;const t=await this.call_api("get",`user/orders?page=${this.currentPage}`);t.data.success?(this.orders=t.data.data,this.totalPages=t.data.meta.last_page,this.currentPage=t.data.meta.current_page):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"}),this.loading=!1},openOrderDetails(t){this.$router.push({name:"OrderDetails",params:{code:t.code}})},async reOrder(t){t.forEach(e=>{this.multipleShop(e)})},multipleShop(t){t.products.data.forEach(e=>{this.addToCart({variation_id:e.product_variation_id,qty:e.quantity})}),this.checkout()},checkout(){this.$router.push({name:"Checkout"}).catch(t=>{this.$route.name=="Checkout"&&this.updateCartDrawer(!1)})},async invoiceDownload(t){t.orders.forEach(async e=>{const n=await this.call_api("get",`order/invoice-download/${e.id}`);if(n.data.success){const _=n.data.invoice_url,c=document.createElement("a");c.href=_,c.download=n.data.invoice_name,c.click()}else this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"})})}},created(){let t=this.$route.query.page||this.currentPage;this.getList(t)}},D={class:"ps-lg-7 pt-4"},V={class:"fs-24 fw-700 opacity-80 mb-5 mt-3"},O={class:"d-block fw-600"},q={class:"opacity-50 fs-13 fw-600"},x={class:"d-block fw-600"},E={key:0,class:"fs-13 opacity-60"},z={class:"d-block fw-600"},B={key:0,class:"text-start"};function L(t,e,n,_,c,i){const h=u("v-btn"),p=u("v-tooltip"),y=u("v-data-table"),k=u("v-pagination");return g(),m("div",D,[o("h1",V,l(t.$t("purchase_history")),1),o("div",null,[r(y,{headers:i.headers,items:t.orders,class:"border px-4 pt-3","loading-text":t.$t("loading_please_wait"),"hide-default-footer":"",loading:t.loading,"item-class":"c-pointer","onClick:row":i.openOrderDetails},{"item.details":s(({item:a})=>[o("span",O,l(a.code),1),o("span",q,l(a.date),1)]),"item.info":s(({item:a})=>[o("span",x,l(i.getProductsCount(a))+" "+l(t.$t("products")),1),t.is_addon_activated("multi_vendor")?(g(),m("span",E,l(t.$t("from"))+" "+l(a.orders.length)+" "+l(t.$t("shops")),1)):w("",!0)]),"item.grand_total":s(({item:a})=>[o("span",z,l(t.format_price(a.grand_total)),1)]),"item.actions":s(({item:a})=>[r(p,{text:"Download Invoice",location:"bottom","open-delay":"200","close-delay":"0"},{activator:s(({props:d})=>[r(h,f(d,{onClick:v=>i.invoiceDownload(a),text:"",size:"small",variant:"flat",class:"text-primary fs-18"}),{default:s(()=>[...e[1]||(e[1]=[o("i",{class:"las la-arrow-circle-down text-primary"},null,-1)])]),_:2},1040,["onClick"])]),_:2},1024),r(p,{text:"Reorder",location:"bottom","open-delay":"200","close-delay":"0"},{activator:s(({props:d})=>[r(h,f(d,{onClick:v=>i.reOrder(a.orders),text:"",size:"small",variant:"flat",class:"text-green fs-18"}),{default:s(()=>[...e[2]||(e[2]=[o("i",{class:"las la-sync"},null,-1)])]),_:2},1040,["onClick"])]),_:2},1024),r(p,{text:"View Details",location:"bottom","open-delay":"200","close-delay":"0"},{activator:s(({props:d})=>[r(h,f(d,{onClick:v=>i.openOrderDetails(a),text:"",size:"small",variant:"flat",class:"text-blue fs-18"}),{default:s(()=>[...e[3]||(e[3]=[o("i",{class:"las la-bars"},null,-1)])]),_:2},1040,["onClick"])]),_:2},1024)]),_:2},1032,["headers","items","loading-text","loading","onClick:row"]),t.totalPages>1?(g(),m("div",B,[r(k,{modelValue:t.currentPage,"onUpdate:modelValue":[e[0]||(e[0]=a=>t.currentPage=a),i.getList],length:t.totalPages,"prev-icon":"las la-angle-left","next-icon":"las la-angle-right","total-visible":7,elevation:"0",class:"my-4"},null,8,["modelValue","onUpdate:modelValue","length"])])):w("",!0)])])}const S=b(P,[["render",L]]);export{S as default};
