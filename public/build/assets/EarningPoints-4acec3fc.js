import{_ as t,h as e,o as a,z as i,w as o,i as s,k as l,t as n,j as c,v as r,n as d,q as u,m as g}from"./app-5a177a8d.js";const h={props:{show:{type:Boolean,required:!0,default:!1},activeClubPoint:{required:!0,default:null}},data:()=>({loading:!1}),computed:{isVisible:{get:function(){return this.show},set:function(t){}}},methods:{closeDialog(){this.isVisible=!1,this.$emit("close")},async convertClubPoint(){if(null!==this.activeClubPoint){this.loading=!0;let t={id:this.activeClubPoint.id};3==(await this.call_api("post","user/convert-point-into-wallet",t)).data?(this.snack({message:this.$i18n.t("the_order_is_not_paid"),color:"red"}),setTimeout(()=>{this.loading=!1},2e3)):(this.snack({message:this.$i18n.t("club_point_converted_to_wallet_successfully"),color:"green"}),setTimeout(()=>{this.loading=!1,window.location.reload()},2e3))}}}},p={key:0,class:"white pa-5 rounded text-center"},m={class:"mb-3 text-capitalize"};const v={data:()=>({loading:!0,pointDialogShow:!1,activeClubPoint:null,currentPage:1,totalPages:1,earningHistories:[]}),components:{PointDialog:t(h,[["render",function(t,g,h,v,_,b){const f=e("v-btn"),w=e("v-dialog");return a(),i(w,{modelValue:b.isVisible,"onUpdate:modelValue":g[0]||(g[0]=t=>b.isVisible=t),"max-width":"700px","onClick:outside":b.closeDialog},{default:o(()=>[h.activeClubPoint?(a(),s("div",p,[l("h2",m,n(t.$t("convert_club_points_to_wallet")),1),c(f,{class:"mr-2",color:"success",elevation:"0",onClick:d(b.convertClubPoint,["stop"]),loading:t.loading,disabled:t.loading},{default:o(()=>[r(n(t.$t("convert_now")),1)]),_:1},8,["onClick","loading","disabled"]),t.loading?u("",!0):(a(),i(f,{key:0,class:"ml-2",color:"warning",elevation:"0",onClick:d(b.closeDialog,["stop"])},{default:o(()=>[r(n(t.$t("cancel")),1)]),_:1},8,["onClick"]))])):u("",!0)]),_:1},8,["modelValue","onClick:outside"])}]])},computed:{...g("app",["generalSettings"]),headers(){return[{title:this.$i18n.t("order_code"),align:"start",sortable:!1,value:"order_code"},{title:this.$i18n.t("points"),sortable:!1,value:"points"},{title:this.$i18n.t("converted"),sortable:!1,value:"converted"},{title:this.$i18n.t("date"),sortable:!1,align:"start",value:"date"},{title:this.$i18n.t("action"),sortable:!1,align:"start",value:"action"}]}},watch:{currentPage(){this.$router.push({query:{...this.$route.query,page:this.currentPage}}).catch(()=>{})}},methods:{async getList(t){this.loading=!0;const e=await this.call_api("get",`user/earning/history?page=${t}`);e.data.success?(this.earningHistories=e.data.data,this.totalPages=e.data.meta.last_page,this.currentPage=e.data.meta.current_page):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"}),this.loading=!1},pointDialogClosed(){this.pointDialogShow=!1},setActiveClubPoint(t){this.activeClubPoint=t,this.pointDialogShow=!0}},created(){let t=this.$route.query.page||this.currentPage;this.getList(t)},mounted(){}},_={class:"ps-lg-7 pt-4"},b={class:"fs-24 fw-700 opacity-80 mb-5 mt-3"},f={class:"fs-16 mb-3 text-primary text-capitalize"},w={class:"fw-700 fs-30"},$={class:"fs-20 fw-700 opacity-80 mb-4"},y={class:"fw-600"},C={class:"fw-600"},P={class:"fw-600"},x={key:0,class:"text-center"};const k=t(v,[["render",function(t,g,h,p,m,v){const k=e("v-sheet"),V=e("v-col"),D=e("v-row"),z=e("point-dialog"),q=e("v-btn"),S=e("v-data-table"),j=e("v-pagination");return a(),s("div",_,[l("h1",b,n(t.$t("my_points")),1),c(D,{class:"mb-4"},{default:o(()=>[c(V,{cols:"12"},{default:o(()=>[c(k,{color:"grey-darken-3",rounded:"rounded",elevation:"1",height:"150",class:"d-flex justify-center align-center white--text flex-column"},{default:o(()=>[l("div",f,n(t.$t("exchange_rate")),1),l("div",w,n(t.generalSettings.club_point_convert_rate)+" "+n(t.$t("points"))+" = "+n(t.format_price(1))+" "+n(t.$t("wallet_money")),1)]),_:1})]),_:1})]),_:1}),l("h2",$,n(t.$t("point_earning_history")),1),l("div",null,[c(z,{show:t.pointDialogShow,onClose:v.pointDialogClosed,activeClubPoint:t.activeClubPoint},null,8,["show","onClose","activeClubPoint"]),c(S,{headers:v.headers,items:t.earningHistories,class:"border px-4 pt-3","loading-text":t.$t("loading_please_wait"),"no-data-text":t.$t("no_data_available")||"Không có dữ liệu","hide-default-footer":"",loading:t.loading},{"item.order_code":o(({item:t})=>[l("span",y,n(t.order_code),1)]),"item.points":o(({item:e})=>[l("span",C,n(e.points)+" "+n(t.$t("pts")),1)]),"item.converted":o(({item:e})=>[1==e.convert_status?(a(),i(q,{key:0,class:"c-initial",size:"x-small",color:"success",elevation:"0"},{default:o(()=>[r(n(t.$t("yes")),1)]),_:1})):(a(),i(q,{key:1,size:"x-small",color:"error",class:"c-initial",elevation:"0"},{default:o(()=>[r(n(t.$t("no")),1)]),_:1}))]),"item.date":o(({item:t})=>[l("span",P,n(t.created_at),1)]),"item.action":o(({item:e})=>[0==e.convert_status?(a(),i(q,{key:0,size:"x-small",color:"warning",elevation:"0",onClick:d(t=>v.setActiveClubPoint(e),["stop"])},{default:o(()=>[r(n(t.$t("convert_now")),1)]),_:2},1032,["onClick"])):(a(),i(q,{key:1,size:"x-small",color:"success",elevation:"0"},{default:o(()=>[r(n(t.$t("done")),1)]),_:1}))]),_:2},1032,["headers","items","loading-text","no-data-text","loading"]),t.totalPages>1?(a(),s("div",x,[c(j,{modelValue:t.currentPage,"onUpdate:modelValue":[g[0]||(g[0]=e=>t.currentPage=e),v.getList],length:t.totalPages,"prev-icon":"las la-angle-left","next-icon":"las la-angle-right","total-visible":7,elevation:"0",class:"my-4"},null,8,["modelValue","onUpdate:modelValue","length"])])):u("",!0)])])}]]);export{k as default};
