import{_ as e,f as a,g as t,h as s,o as l,i as r,k as i,t as o,j as n,H as c,w as d,F as u,p,q as h,z as v,v as m,A as g,n as y}from"./app-5a177a8d.js";const _={data:()=>({loading:!0,currentPage:1,totalPages:1,orders:[],selectedOrder:{},activeTab:"all",searchQuery:"",tabs:[{label:"All",value:"all",count:0},{label:"To Pay",value:"unpaid",count:0},{label:"To Ship",value:"pending",count:0},{label:"To Receive",value:"shipping",count:0},{label:"Completed",value:"delivered",count:0},{label:"Cancelled",value:"cancelled",count:0},{label:"Return/Refund",value:"refund",count:0}],deliveryStatusMap:{all:null,unpaid:"unpaid",pending:"order_placed",shipping:"on_delivery",delivered:"delivered",cancelled:"cancelled",refund:"refund_requested"}}),computed:{},watch:{currentPage(){this.$router.push({query:{...this.$route.query,page:this.currentPage}}).catch(()=>{})},activeTab(){this.$router.push({query:{...this.$route.query,status:this.activeTab,page:1}}).catch(()=>{})}},methods:{...a("cart",["addToCart"]),...t("auth",["updateCartDrawer"]),getProductsCount(e){let a=0;return e.orders.forEach(e=>{a+=e.products.data.length}),a},async getList(){this.loading=!0;let e=`page=${this.currentPage}`;const a=this.deliveryStatusMap[this.activeTab];a&&(e+=`&delivery_status=${a}`),this.searchQuery&&(e+=`&search=${encodeURIComponent(this.searchQuery)}`);const t=await this.call_api("get",`user/orders?${e}`);t.data.success?(this.orders=t.data.data,this.totalPages=t.data.meta.last_page,this.currentPage=t.data.meta.current_page,t.data.counts&&this.updateTabCounts(t.data.counts)):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"}),this.loading=!1},updateTabCounts(e){this.tabs.forEach(a=>{void 0!==e[a.value]&&(a.count=e[a.value])})},onTabChange(e){this.activeTab=e,this.currentPage=1,this.getList()},searchOrders(){this.currentPage=1,this.getList()},clearSearch(){this.searchQuery="",this.currentPage=1,this.getList()},getStatusLabel(e){return{order_placed:this.$i18n.t("order_placed")||"To Ship",confirmed:this.$i18n.t("confirmed")||"Confirmed",on_delivery:this.$i18n.t("on_delivery")||"Shipping",delivered:this.$i18n.t("delivered")||"Completed",cancelled:this.$i18n.t("cancelled")||"Cancelled",refund_requested:this.$i18n.t("refund_requested")||"Refund Requested"}[e]||e},getStatusClass:e=>({order_placed:"status-pending",confirmed:"status-confirmed",on_delivery:"status-shipping",delivered:"status-completed",cancelled:"status-cancelled",refund_requested:"status-refund"}[e]||"status-default"),chatWithShop(e){this.snack({message:this.$i18n.t("chat_feature_coming_soon"),color:"info"})},openOrderDetails(e){this.$router.push({name:"OrderDetails",params:{code:e.code}})},async reOrder(e){e.forEach(e=>{this.multipleShop(e)})},multipleShop(e){e.products.data.forEach(e=>{this.addToCart({variation_id:e.product_variation_id,qty:e.quantity})}),this.checkout()},checkout(){this.$router.push({name:"Checkout"}).catch(e=>{"Checkout"==this.$route.name&&this.updateCartDrawer(!1)})},async invoiceDownload(e){e.orders.forEach(async e=>{const a=await this.call_api("get",`order/invoice-download/${e.id}`);if(a.data.success){const e=a.data.invoice_url,t=document.createElement("a");t.href=e,t.download=a.data.invoice_name,t.click()}else this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"})})}},created(){const e=this.$route.query.status;e&&this.deliveryStatusMap[e]&&(this.activeTab=e);const a=this.$route.query.page;a&&(this.currentPage=parseInt(a)),this.getList()}},f={class:"ps-lg-7 pt-4 purchase-history-shopee"},b={class:"fs-24 fw-700 opacity-80 mb-4 mt-3"},k={class:"search-bar mb-4"},$={class:"order-tabs-wrapper"},C={key:0,class:"tab-count"},w={class:"orders-container"},x={key:0,class:"text-center py-8"},P={class:"mt-4 text-grey"},T={key:1,class:"empty-state"},S={class:"empty-text"},q={key:2},V={class:"order-card-header"},D={class:"d-flex align-center justify-space-between"},O={class:"d-flex align-center gap-3"},L={class:"fw-600 fs-15"},E={class:"text-grey fs-13"},z={class:"d-flex align-center gap-2"},Q={class:"order-card-body"},R={key:0,class:"shop-header"},U=["onClick"],j=["src","alt"],I={class:"product-info"},M={class:"product-name"},A={key:0,class:"product-variation"},F={key:0},H={class:"product-qty"},K={class:"product-price"},W=["onClick"],B={class:"order-card-footer"},G={class:"d-flex align-center justify-space-between"},J={class:"order-info"},N={class:"text-grey fs-13"},X={key:0,class:"text-grey fs-13 ms-3"},Y={class:"d-flex align-center gap-3"},Z={class:"total-amount"},ee={class:"text-grey fs-13 me-2"},ae={class:"amount-value"},te={class:"action-buttons mt-3"},se={key:3,class:"text-center mt-6"};const le=e(_,[["render",function(e,a,t,_,le,re){const ie=s("v-text-field"),oe=s("v-tab"),ne=s("v-tabs"),ce=s("v-progress-circular"),de=s("v-btn"),ue=s("router-link"),pe=s("v-pagination");return l(),r("div",f,[i("h1",b,o(e.$t("purchase_history")),1),i("div",k,[n(ie,{modelValue:e.searchQuery,"onUpdate:modelValue":a[0]||(a[0]=a=>e.searchQuery=a),placeholder:e.$t("search_by_order_code_product_or_shop"),"prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact","hide-details":"",clearable:"",onKeyup:c(re.searchOrders,["enter"]),"onClick:clear":re.clearSearch,class:"search-input"},null,8,["modelValue","placeholder","onKeyup","onClick:clear"])]),i("div",$,[n(ne,{modelValue:e.activeTab,"onUpdate:modelValue":[a[1]||(a[1]=a=>e.activeTab=a),re.onTabChange],class:"order-tabs",color:"primary","slider-color":"primary"},{default:d(()=>[(l(!0),r(u,null,p(e.tabs,e=>(l(),v(oe,{key:e.value,value:e.value,class:"tab-item"},{default:d(()=>[m(o(e.label)+" ",1),e.count>0?(l(),r("span",C,"("+o(e.count)+")",1)):h("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue"])]),i("div",w,[e.loading?(l(),r("div",x,[n(ce,{indeterminate:"",color:"primary",size:"48"}),i("p",P,o(e.$t("loading_please_wait"))+"... ",1)])):e.loading||0!==e.orders.length?(l(),r("div",q,[(l(!0),r(u,null,p(e.orders,t=>(l(),r("div",{key:t.code,class:"order-card"},[i("div",V,[i("div",D,[i("div",O,[a[6]||(a[6]=i("i",{class:"las la-store fs-18 text-grey"},null,-1)),i("span",L,o(t.code),1),a[7]||(a[7]=i("span",{class:"order-divider"},"|",-1)),i("span",E,o(t.date),1)]),i("div",z,[i("span",{class:g([re.getStatusClass(t.delivery_status),"status-badge"])},o(re.getStatusLabel(t.delivery_status)),3)])])]),i("div",Q,[(l(!0),r(u,null,p(t.orders,(s,c)=>(l(),r("div",{key:c,class:"shop-section"},[e.is_addon_activated("multi_vendor")?(l(),r("div",R,[n(ue,{to:{name:"ShopDetails",params:{slug:s.shop.slug}},class:"shop-name"},{default:d(()=>[a[8]||(a[8]=i("i",{class:"las la-store me-1"},null,-1)),m(" "+o(s.shop.name),1)]),_:2},1032,["to"]),n(de,{variant:"outlined",size:"small",class:"chat-btn",onClick:y(e=>re.chatWithShop(s.shop),["stop"])},{default:d(()=>[a[9]||(a[9]=i("i",{class:"las la-comment me-1"},null,-1)),m(" "+o(e.$t("chat")),1)]),_:2},1032,["onClick"])])):h("",!0),(l(!0),r(u,null,p(s.products.data.slice(0,3),s=>(l(),r("div",{key:s.id,class:"product-item",onClick:e=>re.openOrderDetails(t)},[i("img",{src:s.thumbnail,alt:s.name,onError:a[3]||(a[3]=a=>e.imageFallback(a)),class:"product-image"},null,40,j),i("div",I,[i("div",M,o(s.name),1),s.combinations.length>0?(l(),r("div",A,[(l(!0),r(u,null,p(s.combinations,(e,a)=>(l(),r("span",{key:a},[m(o(e.attribute)+": "+o(e.value),1),a<s.combinations.length-1?(l(),r("span",F,", ")):h("",!0)]))),128))])):h("",!0),i("div",H," x"+o(s.quantity),1)]),i("div",K,o(e.format_price(s.price)),1)],8,U))),128)),s.products.data.length>3?(l(),r("div",{key:1,class:"more-products",onClick:e=>re.openOrderDetails(t)}," +"+o(s.products.data.length-3)+" "+o(e.$t("more_products")),9,W)):h("",!0)]))),128))]),i("div",B,[i("div",G,[i("div",J,[i("span",N,o(re.getProductsCount(t))+" "+o(e.$t("products")),1),e.is_addon_activated("multi_vendor")?(l(),r("span",X,o(e.$t("from"))+" "+o(t.orders.length)+" "+o(e.$t("shops")),1)):h("",!0)]),i("div",Y,[i("div",Z,[i("span",ee,o(e.$t("total"))+":",1),i("span",ae,o(e.format_price(t.grand_total)),1)])])]),i("div",te,[n(de,{variant:"outlined",size:"small",onClick:y(e=>re.invoiceDownload(t),["stop"]),class:"action-btn"},{default:d(()=>[a[10]||(a[10]=i("i",{class:"las la-download me-1"},null,-1)),m(" "+o(e.$t("invoice")),1)]),_:2},1032,["onClick"]),n(de,{variant:"outlined",size:"small",color:"primary",onClick:y(e=>re.reOrder(t.orders),["stop"]),class:"action-btn"},{default:d(()=>[a[11]||(a[11]=i("i",{class:"las la-sync me-1"},null,-1)),m(" "+o(e.$t("reorder")),1)]),_:2},1032,["onClick"]),n(de,{variant:"flat",size:"small",color:"primary",onClick:y(e=>re.openOrderDetails(t),["stop"]),class:"action-btn"},{default:d(()=>[m(o(e.$t("view_details")),1)]),_:2},1032,["onClick"])])])]))),128))])):(l(),r("div",T,[a[5]||(a[5]=i("i",{class:"las la-shopping-bag empty-icon"},null,-1)),i("p",S,o(e.$t("no_orders_found")),1),n(de,{color:"primary",variant:"flat",onClick:a[2]||(a[2]=a=>e.$router.push({name:"Home"})),class:"mt-3"},{default:d(()=>[m(o(e.$t("start_shopping")),1)]),_:1})])),e.totalPages>1?(l(),r("div",se,[n(pe,{modelValue:e.currentPage,"onUpdate:modelValue":[a[4]||(a[4]=a=>e.currentPage=a),re.getList],length:e.totalPages,"prev-icon":"las la-angle-left","next-icon":"las la-angle-right","total-visible":7,elevation:"0",class:"custom-pagination"},null,8,["modelValue","onUpdate:modelValue","length"])])):h("",!0)])])}],["__scopeId","data-v-de59d1da"]]);export{le as default};
