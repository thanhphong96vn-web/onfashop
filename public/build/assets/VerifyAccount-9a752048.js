import{_ as t,a as e,c as i,r as s,e as o,b as a,m as n,f as r,g as h,h as l,o as d,i as u,j as c,w as m,k as p,t as g,q as _,n as f,v}from"./app-5a177a8d.js";const w={data:()=>({mobileInputProps:{inputOptions:{type:"tel",placeholder:"phone number"},dropdownOptions:{showDialCodeInSelection:!1,showFlags:!0,showDialCodeInList:!0},autoDefaultCountry:!1,validCharactersOnly:!0,mode:"international"},v$:e(),form:{email:"",phone:"",code:"",invalidPhone:!0,showInvalidPhone:!1},loading:!1,resendLoading:!1}),components:{VueTelInput:i},validations:{form:{email:{requiredIf:s(function(){return"email"==this.authSettings.customer_login_with||"email_phone"==this.authSettings.customer_login_with&&"email"==this.authSettings.customer_otp_with}),email:o},phone:{requiredIf:s(function(){return"phone"==this.authSettings.customer_login_with||"email_phone"==this.authSettings.customer_login_with&&"phone"==this.authSettings.customer_otp_with})},code:{required:a}}},computed:{...n("auth",["authSettings"]),...n("app",["availableCountries"])},methods:{...r("auth",{actionLogin:"login"}),...h("auth",["updateChatWindow","showLoginDialog"]),...r("app",["fetchProductQuerries"]),...r("wishlist",["fetchWislistProducts"]),...r("cart",["fetchCartProducts"]),phoneValidate(t){this.form.invalidPhone=!t.valid,t.valid&&(this.form.showInvalidPhone=!1)},async verifyAccount(){if(!(await this.v$.$validate()))return;if(("phone"==this.authSettings.customer_login_with||"email_phone"==this.authSettings.customer_login_with&&"phone"==this.authSettings.customer_otp_with)&&this.form.invalidPhone)return void(this.form.showInvalidPhone=!0);this.form.phone=this.form.phone.replace(/\s/g,""),this.loading=!0;const t=await this.call_api("post","auth/verify",this.form);t.data.success?(this.actionLogin(t.data),this.showLoginDialog(!1),this.updateChatWindow(!1),this.fetchWislistProducts(),this.fetchProductQuerries(),this.fetchCartProducts(),this.$router.push(this.$route.query.redirect||{name:"DashBoard"})):this.snack({message:t.data.message,color:"red"}),this.loading=!1},async resendCode(){if(this.v$.form.email.$touch(),this.v$.form.email.$anyError)return;if(("phone"==this.authSettings.customer_login_with||"email_phone"==this.authSettings.customer_login_with&&"phone"==this.authSettings.customer_otp_with)&&this.form.invalidPhone)return void(this.form.showInvalidPhone=!0);this.form.phone=this.form.phone.replace(/\s/g,""),this.resendLoading=!0;const t=await this.call_api("post","auth/resend-code",this.form);t.data.success?this.snack({message:t.data.message}):this.snack({message:t.data.message,color:"red"}),this.resendLoading=!1}},created(){this.form.email=this.$route.params.user,this.form.phone=this.$route.params.user}},y={class:"my-5 my-lg-16 rounded-lg pa-5 border overflow-hidden shadow-light"},b={key:0,class:"text-info mb-3"},S={key:1,class:"text-info mb-3"},$={class:"text-uppercase lh-1 mb-4 d-flex"},C={class:"display-1 text-primary fw-00"},P={class:"d-block display-1 fw-900 grey--text text--darken-3 ml-2"},x={class:"mb-4"},k={class:"mb-1 fs-13 fw-500"};const I=t(w,[["render",function(t,e,i,s,o,a){const n=l("v-otp-input"),r=l("v-btn"),h=l("v-form"),w=l("v-col"),I=l("v-row"),L=l("v-container");return d(),u("div",null,[c(L,null,{default:m(()=>[c(I,null,{default:m(()=>[c(w,{cols:"12",lg:"6",md:"8",sm:"10",class:"mx-auto"},{default:m(()=>[p("div",y,["email"==t.authSettings.customer_login_with||"email_phone"==t.authSettings.customer_login_with&&"email"==t.authSettings.customer_otp_with?(d(),u("div",b,g(t.$t("a_verification_code_has_been_sent_to_your_email")),1)):"phone"==t.authSettings.customer_login_with||"email_phone"==t.authSettings.customer_login_with&&"phone"==t.authSettings.customer_otp_with?(d(),u("div",S,g(t.$t("a_verification_code_has_been_sent_to_your_phone_number")),1)):_("",!0),p("h1",$,[p("span",C,g(t.$t("verify")),1),p("span",P,g(t.$t("account")),1)]),c(h,{ref:"loginForm","lazy-validation":"",onSubmit:e[1]||(e[1]=f(t=>a.verifyAccount(),["prevent"]))},{default:m(()=>[p("div",x,[p("div",k,g(t.$t("enter_your_verification_code")),1),c(n,{modelValue:t.form.code,"onUpdate:modelValue":e[0]||(e[0]=e=>t.form.code=e),length:"6",type:"number","error-messages":t.codeErrors,"hide-details":"auto",disabled:t.loading,required:""},null,8,["modelValue","error-messages","disabled"])]),c(r,{size:"x-large",class:"px-12 mb-4 btn-primary",elevation:"0",type:"submit",loading:t.loading,disabled:t.loading,onClick:a.verifyAccount},{default:m(()=>[v(g(t.$t("verify")),1)]),_:1},8,["loading","disabled","onClick"]),c(r,{size:"x-large",class:"px-12 mb-4 ms-3",elevation:"0",type:"button",color:"grey-lighten-4",loading:t.resendLoading,disabled:t.resendLoading,onClick:a.resendCode},{default:m(()=>[v(g(t.$t("resend_code")),1)]),_:1},8,["loading","disabled","onClick"])]),_:1},512)])]),_:1})]),_:1})]),_:1})])}]]);export{I as default};
