import{_ as e,a as s,b as a,m as l,g as t,f as d,h as i,o as r,i as o,k as n,t as u,j as p,w as f,v as m,n as c,q as h,z as g,F as v,p as w,s as _}from"./app-0e743bd7.js";import{A as b}from"./AddressDialog-00540a16.js";const $={data:()=>({v$:s(),form:{name:"",email:"",phone:"",avatar:"",previewAvatar:"",oldPassword:"",password:"",confirmPassword:""},passwordShow:!1,addDialogShow:!1,infoUpdateLoading:!1,addressSelectedForEdit:{}}),components:{AddressDialog:b},validations:{form:{name:{required:a},password:{minLength:e=>!e||e.length>=6},confirmPassword:{minLength:e=>!e||e.length>=6}}},computed:{...l("auth",["currentUser"]),...l("address",["getAddresses","addressesLoaded","getDefaultShippingAddress","getDefaultBillingAddress"])},created(){this.form.name=this.currentUser.name,this.form.email=this.currentUser.email,this.form.phone=this.currentUser.phone,this.form.previewAvatar=this.currentUser.avatar,this.fetchAddresses()},methods:{...t("auth",["setUser"]),...t("address",["setAddresses"]),...d("address",["fetchAddresses"]),previewThumbnail(e){if(this.form.avatar=e.target.files[0],e.target.files&&e.target.files[0]){const s=new FileReader;s.onload=e=>{this.form.previewAvatar=e.target.result},s.readAsDataURL(e.target.files[0])}},async updateBasic(){this.v$.form.name.$touch(),this.form.password&&this.v$.form.password.$touch(),this.form.confirmPassword&&this.v$.form.confirmPassword.$touch();const e=await this.v$.form.name.$validate(),s=!this.form.password||await this.v$.form.password.$validate(),a=!this.form.confirmPassword||await this.v$.form.confirmPassword.$validate();if(!e||!s||!a)return void console.log("Validation failed:",{name:this.v$.form.name.$errors,password:this.v$.form.password.$errors,confirmPassword:this.v$.form.confirmPassword.$errors});console.log("Validation passed, calling API..."),this.form.phone&&(this.form.phone=this.form.phone.replace(/\D/g,"")),this.infoUpdateLoading=!0;let l=new FormData;for(var t in this.form)"password"===t||"confirmPassword"===t?this.form[t]&&l.append(t,this.form[t]):l.append(t,this.form[t]);const d=await this.call_api("post","user/info/update",l,!0);d.data.success?(this.setUser(d.data.user),this.snack({message:d.data.message}),this.form.password="",this.form.confirmPassword=""):this.snack({message:d.data.message,color:"red"}),this.infoUpdateLoading=!1},async deleteAddress(e){const s=await this.call_api("get",`user/address/delete/${e}`);s.data.success&&(this.setAddresses(s.data.data),this.snack({message:s.data.message}))},editAddress(e){this.addressSelectedForEdit=e,this.addDialogShow=!0},async markDefaultShipping(e){const s=await this.call_api("get",`user/address/default-shipping/${e}`);s.data.success?(this.setAddresses(s.data.data),this.snack({message:s.data.message})):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"})},async markDefaultBilling(e){const s=await this.call_api("get",`user/address/default-billing/${e}`);s.data.success?(this.setAddresses(s.data.data),this.snack({message:s.data.message})):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"})},addressDialogClosed(){this.addressSelectedForEdit={},this.addDialogShow=!1}}},y={class:"ps-lg-7 pt-4"},A={class:"fs-21 fw-700 opacity-80 mb-5"},D={class:"d-flex flex-column align-center justify-center border rounded pa-6 mb-3"},k={class:"avatar-upload"},S=["src"],U={for:"avatar-input",class:"border border-gray-300 fs-14 fw-500 grey lighten-4 mt-3 opacity-50 px-4 py-1 rounded c-pointer"},V={class:""},C={class:"fs-13 fw-600 opacity-80 mb-2"},P={key:0,class:"border rounded pa-4 fs-13"},B={class:"fs-13 fw-600 opacity-80 mb-2"},L={key:0,class:"border rounded pa-4 fs-13"},x={class:"border rounded py-4 ps-4 pe-9 fs-13 position-relative"},F={key:1,class:"text-center"};const j=e($,[["render",function(e,s,a,l,t,d){const b=i("v-card-title"),$=i("v-text-field"),j=i("v-avatar"),E=i("v-btn"),T=i("v-form"),q=i("v-card"),z=i("address-dialog"),I=i("v-col"),R=i("v-row"),G=i("v-list-item-title"),H=i("v-list-item"),J=i("v-list"),K=i("v-menu");return r(),o("div",y,[n("h1",A,u(e.$t("profile")),1),p(R,null,{default:f(()=>[p(I,{xl:"8"},{default:f(()=>[p(q,{elevation:"0",class:"mb-6"},{default:f(()=>[p(b,{class:"pa-0 fs-16 fw-700"},{default:f(()=>[m(u(e.$t("profile_information")),1)]),_:1}),p(T,{class:"py-4",onSubmit:s[8]||(s[8]=c(e=>d.updateBasic(),["prevent"])),enctype:"multipart/form-data"},{default:f(()=>[s[11]||(s[11]=n("input",{type:"email",name:"hidden",style:{width:"0",height:"0",border:"0",padding:"0"}},null,-1)),s[12]||(s[12]=n("input",{type:"password",name:"hidden",style:{width:"0",height:"0",border:"0",padding:"0"}},null,-1)),n("label",null,u(e.$t("full_name")),1),p($,{placeholder:e.$t("full_name"),modelValue:e.form.name,"onUpdate:modelValue":s[0]||(s[0]=s=>e.form.name=s),variant:"outlined","hide-details":"auto",class:"mb-3"},null,8,["placeholder","modelValue"]),n("label",null,u(e.$t("email")),1),p($,{placeholder:e.$t("email_address"),modelValue:e.form.email,"onUpdate:modelValue":s[1]||(s[1]=s=>e.form.email=s),variant:"outlined","hide-details":"auto",class:"mb-3",disabled:""},null,8,["placeholder","modelValue"]),n("label",null,u(e.$t("phone_number")),1),p($,{placeholder:e.$t("phone_number"),modelValue:e.form.phone,"onUpdate:modelValue":s[2]||(s[2]=s=>e.form.phone=s),type:"tel",onInput:s[3]||(s[3]=s=>e.form.phone=e.form.phone.replace(/\D/g,"")),variant:"outlined","hide-details":"auto",class:"mb-3",maxlength:"10",disabled:""},null,8,["placeholder","modelValue"]),n("label",null,u(e.$t("new_password")),1),p($,{placeholder:"******",type:"password",modelValue:e.form.password,"onUpdate:modelValue":s[4]||(s[4]=s=>e.form.password=s),variant:"outlined","hide-details":"auto",class:"mb-3"},null,8,["modelValue"]),n("label",null,u(e.$t("confirm_password")),1),p($,{placeholder:"******",type:"password",modelValue:e.form.confirmPassword,"onUpdate:modelValue":s[5]||(s[5]=s=>e.form.confirmPassword=s),variant:"outlined","hide-details":"auto",class:"mb-3"},null,8,["modelValue"]),n("label",null,u(e.$t("profile_image")),1),n("div",D,[n("div",k,[p(j,{size:"160",class:""},{default:f(()=>[n("img",{src:e.form.previewAvatar,onError:s[6]||(s[6]=s=>e.imageFallback(s)),class:"user-dashboard-profile-image"},null,40,S)]),_:1}),n("label",null,[n("input",{type:"file",id:"avatar-input",accept:"image/png, image/jpg, image/jpeg",onChange:s[7]||(s[7]=(...e)=>d.previewThumbnail&&d.previewThumbnail(...e))},null,32),s[10]||(s[10]=n("i",{class:"las la-image"},null,-1))])]),n("label",U,u(e.$t("select_image")),1)]),p(E,{type:"submit",loading:e.infoUpdateLoading,disabled:e.infoUpdateLoading,elevation:"0",class:"px-10 btn-primary",onClick:d.updateBasic},{default:f(()=>[m(u(e.$t("update")),1)]),_:1},8,["loading","disabled","onClick"])]),_:1})]),_:1}),p(q,{elevation:"0"},{default:f(()=>[p(z,{show:e.addDialogShow,onClose:d.addressDialogClosed,"old-address":e.addressSelectedForEdit},null,8,["show","onClose","old-address"]),p(b,{class:"pa-0 fs-16 fw-700 mb-4"},{default:f(()=>[n("span",V,u(e.$t("addresses")),1),p(E,{elevation:"0",class:"ms-auto float-right btn-primary",onClick:s[9]||(s[9]=c(s=>e.addDialogShow=!0,["stop"]))},{default:f(()=>[m(u(e.$t("add_new")),1)]),_:1})]),_:1}),p(R,{class:"mb-4 row-cols-1 row-cols-sm-2 gutters-10"},{default:f(()=>[p(I,null,{default:f(()=>[n("div",C,u(e.$t("default_shipping_address")),1),e.getDefaultShippingAddress?(r(),o("div",P,[n("div",null,u(e.getDefaultShippingAddress.address),1),n("div",null,u(e.getDefaultShippingAddress.postal_code)+", "+u(e.getDefaultShippingAddress.city)+", "+u(e.getDefaultShippingAddress.state),1),n("div",null,u(e.getDefaultShippingAddress.country),1),n("div",null,u(e.getDefaultShippingAddress.phone),1)])):h("",!0)]),_:1}),p(I,null,{default:f(()=>[n("div",B,u(e.$t("default_billing_address")),1),e.getDefaultBillingAddress?(r(),o("div",L,[n("div",null,u(e.getDefaultBillingAddress.address),1),n("div",null,u(e.getDefaultBillingAddress.postal_code)+", "+u(e.getDefaultBillingAddress.city)+", "+u(e.getDefaultBillingAddress.state),1),n("div",null,u(e.getDefaultBillingAddress.country),1),n("div",null,u(e.getDefaultBillingAddress.phone),1)])):h("",!0)]),_:1})]),_:1})]),_:1}),p(q,{elevation:"0"},{default:f(()=>[p(b,{class:"pa-0 fs-16 fw-700 mb-4"},{default:f(()=>[m(u(e.$t("all_addresses")),1)]),_:1}),n("div",null,[e.addressesLoaded&&e.getAddresses.length>0?(r(),g(R,{key:0,class:"row-cols-1 row-cols-sm-2 gutters-10"},{default:f(()=>[(r(!0),o(v,null,w(e.getAddresses,(a,l)=>(r(),g(I,{key:l},{default:f(()=>[n("div",x,[n("div",null,u(a.address),1),n("div",null,u(a.postal_code)+", "+u(a.city)+", "+u(a.state),1),n("div",null,u(a.country),1),n("div",null,u(a.phone),1),p(K,{"offset-y":"",left:""},{activator:f(({props:e})=>[p(E,_({ref_for:!0},e,{class:"absolute-top-right",color:"transparent",elevation:"0",fab:"",small:""}),{default:f(()=>[...s[13]||(s[13]=[n("i",{class:"las la-ellipsis-v fs-18"},null,-1)])]),_:2},1040)]),default:f(()=>[p(J,{class:""},{default:f(()=>[p(H,{class:"c-pointer",onClick:e=>d.editAddress(a)},{default:f(()=>[p(G,null,{default:f(()=>[m(u(e.$t("edit")),1)]),_:1})]),_:2},1032,["onClick"]),p(H,{class:"c-pointer",onClick:e=>d.markDefaultShipping(a.id)},{default:f(()=>[p(G,null,{default:f(()=>[m(u(e.$t("mark_as_default_shipping_address")),1)]),_:1})]),_:2},1032,["onClick"]),p(H,{class:"c-pointer",onClick:e=>d.markDefaultBilling(a.id)},{default:f(()=>[p(G,null,{default:f(()=>[m(u(e.$t("mark_as_default_billing_address")),1)]),_:1})]),_:2},1032,["onClick"]),p(H,{class:"c-pointer",onClick:e=>d.deleteAddress(a.id)},{default:f(()=>[p(G,null,{default:f(()=>[m(u(e.$t("delete")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)])]),_:2},1024))),128))]),_:1})):(r(),o("div",F,[n("div",null,u(e.$t("no_saved_address")),1)]))])]),_:1})]),_:1}),p(I,{cols:"auto"})]),_:1})])}]]);export{j as default};
