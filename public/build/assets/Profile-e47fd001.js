import{_ as T,a as q,b as z,y as A,m as k,g as D,f as M,h as i,o as n,i as p,k as t,t as a,j as l,w as o,v as u,n as S,F as C,p as V,q as U,z as B,s as R}from"./app-41f27463.js";import{A as G}from"./AddressDialog-5051d38c.js";const I={data:()=>({v$:q(),form:{name:"",email:"",phone:"",avatar:"",previewAvatar:"",oldPassword:"",password:"",confirmPassword:""},passwordShow:!1,addDialogShow:!1,infoUpdateLoading:!1,addressSelectedForEdit:{}}),components:{AddressDialog:G},validations:{form:{name:{required:z},phone:{phoneFormat:e=>e?/^\d{10}$/.test(e):!0},password:{minLength:A(6)},confirmPassword:{minLength:A(6)}}},computed:{...k("auth",["currentUser"]),...k("address",["getAddresses","addressesLoaded","getDefaultShippingAddress","getDefaultBillingAddress"])},created(){this.form.name=this.currentUser.name,this.form.email=this.currentUser.email,this.form.phone=this.currentUser.phone,this.form.previewAvatar=this.currentUser.avatar,this.fetchAddresses()},methods:{...D("auth",["setUser"]),...D("address",["setAddresses"]),...M("address",["fetchAddresses"]),previewThumbnail(e){if(this.form.avatar=e.target.files[0],e.target.files&&e.target.files[0]){const s=new FileReader;s.onload=m=>{this.form.previewAvatar=m.target.result},s.readAsDataURL(e.target.files[0])}},async updateBasic(){if(this.v$.$touch(),!await this.v$.$validate())return;this.form.phone=this.form.phone.replace(/\D/g,""),this.infoUpdateLoading=!0;let s=new FormData;for(var m in this.form)s.append(m,this.form[m]);const f=await this.call_api("post","user/info/update",s,!0);f.data.success?(this.setUser(f.data.user),this.snack({message:f.data.message})):this.snack({message:f.data.message,color:"red"}),this.infoUpdateLoading=!1},async deleteAddress(e){const s=await this.call_api("get",`user/address/delete/${e}`);s.data.success&&(this.setAddresses(s.data.data),this.snack({message:s.data.message}))},editAddress(e){this.addressSelectedForEdit=e,this.addDialogShow=!0},async markDefaultShipping(e){const s=await this.call_api("get",`user/address/default-shipping/${e}`);s.data.success?(this.setAddresses(s.data.data),this.snack({message:s.data.message})):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"})},async markDefaultBilling(e){const s=await this.call_api("get",`user/address/default-billing/${e}`);s.data.success?(this.setAddresses(s.data.data),this.snack({message:s.data.message})):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"})},addressDialogClosed(){this.addressSelectedForEdit={},this.addDialogShow=!1}}},H={class:"ps-lg-7 pt-4"},J={class:"fs-21 fw-700 opacity-80 mb-5"},K={class:"d-flex flex-column align-center justify-center border rounded pa-6 mb-3"},O={class:"avatar-upload"},Q=["src"],W={for:"avatar-input",class:"border border-gray-300 fs-14 fw-500 grey lighten-4 mt-3 opacity-50 px-4 py-1 rounded c-pointer"},X={class:""},Y={class:"fs-13 fw-600 opacity-80 mb-2"},Z={key:0,class:"border rounded pa-4 fs-13"},x={class:"fs-13 fw-600 opacity-80 mb-2"},ee={key:0,class:"border rounded pa-4 fs-13"},se={class:"border rounded py-4 ps-4 pe-9 fs-13 position-relative"},ae={key:1,class:"text-center"};function te(e,s,m,f,le,r){const _=i("v-card-title"),g=i("v-text-field"),F=i("v-avatar"),b=i("v-btn"),L=i("v-form"),y=i("v-card"),P=i("address-dialog"),h=i("v-col"),$=i("v-row"),v=i("v-list-item-title"),w=i("v-list-item"),E=i("v-list"),j=i("v-menu");return n(),p("div",H,[t("h1",J,a(e.$t("profile")),1),l($,null,{default:o(()=>[l(h,{xl:"8"},{default:o(()=>[l(y,{elevation:"0",class:"mb-6"},{default:o(()=>[l(_,{class:"pa-0 fs-16 fw-700"},{default:o(()=>[u(a(e.$t("profile_information")),1)]),_:1}),l(L,{class:"py-4",onSubmit:s[8]||(s[8]=S(d=>r.updateBasic(),["prevent"])),enctype:"multipart/form-data"},{default:o(()=>[s[11]||(s[11]=t("input",{type:"email",name:"hidden",style:{width:"0",height:"0",border:"0",padding:"0"}},null,-1)),s[12]||(s[12]=t("input",{type:"password",name:"hidden",style:{width:"0",height:"0",border:"0",padding:"0"}},null,-1)),t("label",null,a(e.$t("full_name")),1),l(g,{placeholder:e.$t("full_name"),modelValue:e.form.name,"onUpdate:modelValue":s[0]||(s[0]=d=>e.form.name=d),variant:"outlined","hide-details":"auto",class:"mb-3"},null,8,["placeholder","modelValue"]),t("label",null,a(e.$t("email")),1),l(g,{placeholder:e.$t("email_address"),modelValue:e.form.email,"onUpdate:modelValue":s[1]||(s[1]=d=>e.form.email=d),variant:"outlined","hide-details":"auto",class:"mb-3",disabled:""},null,8,["placeholder","modelValue"]),t("label",null,a(e.$t("phone_number")),1),l(g,{placeholder:e.$t("phone_number"),modelValue:e.form.phone,"onUpdate:modelValue":s[2]||(s[2]=d=>e.form.phone=d),type:"tel",onInput:s[3]||(s[3]=d=>e.form.phone=e.form.phone.replace(/\D/g,"")),variant:"outlined","hide-details":"auto",class:"mb-3",maxlength:"10"},null,8,["placeholder","modelValue"]),(n(!0),p(C,null,V(e.v$.form.phone.$errors,d=>(n(),p("p",{key:d.$uid,class:"text-red"},a(d.$message),1))),128)),t("label",null,a(e.$t("new_password")),1),l(g,{placeholder:"******",type:"password",modelValue:e.form.password,"onUpdate:modelValue":s[4]||(s[4]=d=>e.form.password=d),variant:"outlined","hide-details":"auto",class:"mb-3"},null,8,["modelValue"]),t("label",null,a(e.$t("confirm_password")),1),l(g,{placeholder:"******",type:"password",modelValue:e.form.confirmPassword,"onUpdate:modelValue":s[5]||(s[5]=d=>e.form.confirmPassword=d),variant:"outlined","hide-details":"auto",class:"mb-3"},null,8,["modelValue"]),t("label",null,a(e.$t("profile_image")),1),t("div",K,[t("div",O,[l(F,{size:"160",class:""},{default:o(()=>[t("img",{src:e.form.previewAvatar,onError:s[6]||(s[6]=d=>e.imageFallback(d)),class:"user-dashboard-profile-image"},null,40,Q)]),_:1}),t("label",null,[t("input",{type:"file",id:"avatar-input",accept:"image/png, image/jpg, image/jpeg",onChange:s[7]||(s[7]=(...d)=>r.previewThumbnail&&r.previewThumbnail(...d))},null,32),s[10]||(s[10]=t("i",{class:"las la-image"},null,-1))])]),t("label",W,a(e.$t("select_image")),1)]),l(b,{type:"submit",loading:e.infoUpdateLoading,disabled:e.infoUpdateLoading,elevation:"0",class:"px-10 btn-primary",onClick:r.updateBasic},{default:o(()=>[u(a(e.$t("update")),1)]),_:1},8,["loading","disabled","onClick"])]),_:1})]),_:1}),l(y,{elevation:"0"},{default:o(()=>[l(P,{show:e.addDialogShow,onClose:r.addressDialogClosed,"old-address":e.addressSelectedForEdit},null,8,["show","onClose","old-address"]),l(_,{class:"pa-0 fs-16 fw-700 mb-4"},{default:o(()=>[t("span",X,a(e.$t("addresses")),1),l(b,{elevation:"0",class:"ms-auto float-right btn-primary",onClick:s[9]||(s[9]=S(d=>e.addDialogShow=!0,["stop"]))},{default:o(()=>[u(a(e.$t("add_new")),1)]),_:1})]),_:1}),l($,{class:"mb-4 row-cols-1 row-cols-sm-2 gutters-10"},{default:o(()=>[l(h,null,{default:o(()=>[t("div",Y,a(e.$t("default_shipping_address")),1),e.getDefaultShippingAddress?(n(),p("div",Z,[t("div",null,a(e.getDefaultShippingAddress.address),1),t("div",null,a(e.getDefaultShippingAddress.postal_code)+", "+a(e.getDefaultShippingAddress.city)+", "+a(e.getDefaultShippingAddress.state),1),t("div",null,a(e.getDefaultShippingAddress.country),1),t("div",null,a(e.getDefaultShippingAddress.phone),1)])):U("",!0)]),_:1}),l(h,null,{default:o(()=>[t("div",x,a(e.$t("default_billing_address")),1),e.getDefaultBillingAddress?(n(),p("div",ee,[t("div",null,a(e.getDefaultBillingAddress.address),1),t("div",null,a(e.getDefaultBillingAddress.postal_code)+", "+a(e.getDefaultBillingAddress.city)+", "+a(e.getDefaultBillingAddress.state),1),t("div",null,a(e.getDefaultBillingAddress.country),1),t("div",null,a(e.getDefaultBillingAddress.phone),1)])):U("",!0)]),_:1})]),_:1})]),_:1}),l(y,{elevation:"0"},{default:o(()=>[l(_,{class:"pa-0 fs-16 fw-700 mb-4"},{default:o(()=>[u(a(e.$t("all_addresses")),1)]),_:1}),t("div",null,[e.addressesLoaded&&e.getAddresses.length>0?(n(),B($,{key:0,class:"row-cols-1 row-cols-sm-2 gutters-10"},{default:o(()=>[(n(!0),p(C,null,V(e.getAddresses,(d,N)=>(n(),B(h,{key:N},{default:o(()=>[t("div",se,[t("div",null,a(d.address),1),t("div",null,a(d.postal_code)+", "+a(d.city)+", "+a(d.state),1),t("div",null,a(d.country),1),t("div",null,a(d.phone),1),l(j,{"offset-y":"",left:""},{activator:o(({props:c})=>[l(b,R({ref_for:!0},c,{class:"absolute-top-right",color:"transparent",elevation:"0",fab:"",small:""}),{default:o(()=>[...s[13]||(s[13]=[t("i",{class:"las la-ellipsis-v fs-18"},null,-1)])]),_:2},1040)]),default:o(()=>[l(E,{class:""},{default:o(()=>[l(w,{class:"c-pointer",onClick:c=>r.editAddress(d)},{default:o(()=>[l(v,null,{default:o(()=>[u(a(e.$t("edit")),1)]),_:1})]),_:2},1032,["onClick"]),l(w,{class:"c-pointer",onClick:c=>r.markDefaultShipping(d.id)},{default:o(()=>[l(v,null,{default:o(()=>[u(a(e.$t("mark_as_default_shipping_address")),1)]),_:1})]),_:2},1032,["onClick"]),l(w,{class:"c-pointer",onClick:c=>r.markDefaultBilling(d.id)},{default:o(()=>[l(v,null,{default:o(()=>[u(a(e.$t("mark_as_default_billing_address")),1)]),_:1})]),_:2},1032,["onClick"]),l(w,{class:"c-pointer",onClick:c=>r.deleteAddress(d.id)},{default:o(()=>[l(v,null,{default:o(()=>[u(a(e.$t("delete")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)])]),_:2},1024))),128))]),_:1})):(n(),p("div",ae,[t("div",null,a(e.$t("no_saved_address")),1)]))])]),_:1})]),_:1}),l(h,{cols:"auto"})]),_:1})])}const ie=T(I,[["render",te]]);export{ie as default};
