import{_ as N,a as j,b as T,m as y,g as k,f as q,h as r,o as m,i as h,k as t,t as a,j as l,w as d,v as u,n as V,q as S,B as C,F as I,p as M,s as R}from"./app-97cff8f8.js";import{A as z}from"./AddressDialog-8f94e234.js";const G={data:()=>({v$:j(),form:{name:"",email:"",phone:"",avatar:"",previewAvatar:"",oldPassword:"",password:"",confirmPassword:""},passwordShow:!1,addDialogShow:!1,infoUpdateLoading:!1,addressSelectedForEdit:{}}),components:{AddressDialog:z},validations:{form:{name:{required:T},password:{minLength:e=>e?e.length>=6:!0},confirmPassword:{minLength:e=>e?e.length>=6:!0}}},computed:{...y("auth",["currentUser"]),...y("address",["getAddresses","addressesLoaded","getDefaultShippingAddress","getDefaultBillingAddress"])},created(){this.form.name=this.currentUser.name,this.form.email=this.currentUser.email,this.form.phone=this.currentUser.phone,this.form.previewAvatar=this.currentUser.avatar,this.fetchAddresses()},methods:{...k("auth",["setUser"]),...k("address",["setAddresses"]),...q("address",["fetchAddresses"]),previewThumbnail(e){if(this.form.avatar=e.target.files[0],e.target.files&&e.target.files[0]){const s=new FileReader;s.onload=c=>{this.form.previewAvatar=c.target.result},s.readAsDataURL(e.target.files[0])}},async updateBasic(){this.v$.form.name.$touch(),this.form.password&&this.v$.form.password.$touch(),this.form.confirmPassword&&this.v$.form.confirmPassword.$touch();const e=await this.v$.form.name.$validate(),s=!this.form.password||await this.v$.form.password.$validate(),c=!this.form.confirmPassword||await this.v$.form.confirmPassword.$validate();if(!e||!s||!c){console.log("Validation failed:",{name:this.v$.form.name.$errors,password:this.v$.form.password.$errors,confirmPassword:this.v$.form.confirmPassword.$errors});return}console.log("Validation passed, calling API..."),this.form.phone&&(this.form.phone=this.form.phone.replace(/\D/g,"")),this.infoUpdateLoading=!0;let v=new FormData;for(var n in this.form)n==="password"||n==="confirmPassword"?this.form[n]&&v.append(n,this.form[n]):v.append(n,this.form[n]);const i=await this.call_api("post","user/info/update",v,!0);i.data.success?(this.setUser(i.data.user),this.snack({message:i.data.message}),this.form.password="",this.form.confirmPassword=""):this.snack({message:i.data.message,color:"red"}),this.infoUpdateLoading=!1},async deleteAddress(e){const s=await this.call_api("get",`user/address/delete/${e}`);s.data.success&&(this.setAddresses(s.data.data),this.snack({message:s.data.message}))},editAddress(e){this.addressSelectedForEdit=e,this.addDialogShow=!0},async markDefaultShipping(e){const s=await this.call_api("get",`user/address/default-shipping/${e}`);s.data.success?(this.setAddresses(s.data.data),this.snack({message:s.data.message})):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"})},async markDefaultBilling(e){const s=await this.call_api("get",`user/address/default-billing/${e}`);s.data.success?(this.setAddresses(s.data.data),this.snack({message:s.data.message})):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"})},addressDialogClosed(){this.addressSelectedForEdit={},this.addDialogShow=!1}}},H={class:"ps-lg-7 pt-4"},J={class:"fs-21 fw-700 opacity-80 mb-5"},K={class:"d-flex flex-column align-center justify-center border rounded pa-6 mb-3"},O={class:"avatar-upload"},Q=["src"],W={for:"avatar-input",class:"border border-gray-300 fs-14 fw-500 grey lighten-4 mt-3 opacity-50 px-4 py-1 rounded c-pointer"},X={class:""},Y={class:"fs-13 fw-600 opacity-80 mb-2"},Z={key:0,class:"border rounded pa-4 fs-13"},x={class:"fs-13 fw-600 opacity-80 mb-2"},ee={key:0,class:"border rounded pa-4 fs-13"},se={class:"border rounded py-4 ps-4 pe-9 fs-13 position-relative"},ae={key:1,class:"text-center"};function te(e,s,c,v,n,i){const b=r("v-card-title"),f=r("v-text-field"),B=r("v-avatar"),$=r("v-btn"),P=r("v-form"),A=r("v-card"),U=r("address-dialog"),p=r("v-col"),D=r("v-row"),w=r("v-list-item-title"),_=r("v-list-item"),L=r("v-list"),F=r("v-menu");return m(),h("div",H,[t("h1",J,a(e.$t("profile")),1),l(D,null,{default:d(()=>[l(p,{xl:"8"},{default:d(()=>[l(A,{elevation:"0",class:"mb-6"},{default:d(()=>[l(b,{class:"pa-0 fs-16 fw-700"},{default:d(()=>[u(a(e.$t("profile_information")),1)]),_:1}),l(P,{class:"py-4",onSubmit:s[8]||(s[8]=V(o=>i.updateBasic(),["prevent"])),enctype:"multipart/form-data"},{default:d(()=>[s[11]||(s[11]=t("input",{type:"email",name:"hidden",style:{width:"0",height:"0",border:"0",padding:"0"}},null,-1)),s[12]||(s[12]=t("input",{type:"password",name:"hidden",style:{width:"0",height:"0",border:"0",padding:"0"}},null,-1)),t("label",null,a(e.$t("full_name")),1),l(f,{placeholder:e.$t("full_name"),modelValue:e.form.name,"onUpdate:modelValue":s[0]||(s[0]=o=>e.form.name=o),variant:"outlined","hide-details":"auto",class:"mb-3"},null,8,["placeholder","modelValue"]),t("label",null,a(e.$t("email")),1),l(f,{placeholder:e.$t("email_address"),modelValue:e.form.email,"onUpdate:modelValue":s[1]||(s[1]=o=>e.form.email=o),variant:"outlined","hide-details":"auto",class:"mb-3",disabled:""},null,8,["placeholder","modelValue"]),t("label",null,a(e.$t("phone_number")),1),l(f,{placeholder:e.$t("phone_number"),modelValue:e.form.phone,"onUpdate:modelValue":s[2]||(s[2]=o=>e.form.phone=o),type:"tel",onInput:s[3]||(s[3]=o=>e.form.phone=e.form.phone.replace(/\D/g,"")),variant:"outlined","hide-details":"auto",class:"mb-3",maxlength:"10",disabled:""},null,8,["placeholder","modelValue"]),t("label",null,a(e.$t("new_password")),1),l(f,{placeholder:"******",type:"password",modelValue:e.form.password,"onUpdate:modelValue":s[4]||(s[4]=o=>e.form.password=o),variant:"outlined","hide-details":"auto",class:"mb-3"},null,8,["modelValue"]),t("label",null,a(e.$t("confirm_password")),1),l(f,{placeholder:"******",type:"password",modelValue:e.form.confirmPassword,"onUpdate:modelValue":s[5]||(s[5]=o=>e.form.confirmPassword=o),variant:"outlined","hide-details":"auto",class:"mb-3"},null,8,["modelValue"]),t("label",null,a(e.$t("profile_image")),1),t("div",K,[t("div",O,[l(B,{size:"160",class:""},{default:d(()=>[t("img",{src:e.form.previewAvatar,onError:s[6]||(s[6]=o=>e.imageFallback(o)),class:"user-dashboard-profile-image"},null,40,Q)]),_:1}),t("label",null,[t("input",{type:"file",id:"avatar-input",accept:"image/png, image/jpg, image/jpeg",onChange:s[7]||(s[7]=(...o)=>i.previewThumbnail&&i.previewThumbnail(...o))},null,32),s[10]||(s[10]=t("i",{class:"las la-image"},null,-1))])]),t("label",W,a(e.$t("select_image")),1)]),l($,{type:"submit",loading:e.infoUpdateLoading,disabled:e.infoUpdateLoading,elevation:"0",class:"px-10 btn-primary",onClick:i.updateBasic},{default:d(()=>[u(a(e.$t("update")),1)]),_:1},8,["loading","disabled","onClick"])]),_:1})]),_:1}),l(A,{elevation:"0"},{default:d(()=>[l(U,{show:e.addDialogShow,onClose:i.addressDialogClosed,"old-address":e.addressSelectedForEdit},null,8,["show","onClose","old-address"]),l(b,{class:"pa-0 fs-16 fw-700 mb-4"},{default:d(()=>[t("span",X,a(e.$t("addresses")),1),l($,{elevation:"0",class:"ms-auto float-right btn-primary",onClick:s[9]||(s[9]=V(o=>e.addDialogShow=!0,["stop"]))},{default:d(()=>[u(a(e.$t("add_new")),1)]),_:1})]),_:1}),l(D,{class:"mb-4 row-cols-1 row-cols-sm-2 gutters-10"},{default:d(()=>[l(p,null,{default:d(()=>[t("div",Y,a(e.$t("default_shipping_address")),1),e.getDefaultShippingAddress?(m(),h("div",Z,[t("div",null,a(e.getDefaultShippingAddress.address),1),t("div",null,a(e.getDefaultShippingAddress.postal_code)+", "+a(e.getDefaultShippingAddress.city)+", "+a(e.getDefaultShippingAddress.state),1),t("div",null,a(e.getDefaultShippingAddress.country),1),t("div",null,a(e.getDefaultShippingAddress.phone),1)])):S("",!0)]),_:1}),l(p,null,{default:d(()=>[t("div",x,a(e.$t("default_billing_address")),1),e.getDefaultBillingAddress?(m(),h("div",ee,[t("div",null,a(e.getDefaultBillingAddress.address),1),t("div",null,a(e.getDefaultBillingAddress.postal_code)+", "+a(e.getDefaultBillingAddress.city)+", "+a(e.getDefaultBillingAddress.state),1),t("div",null,a(e.getDefaultBillingAddress.country),1),t("div",null,a(e.getDefaultBillingAddress.phone),1)])):S("",!0)]),_:1})]),_:1})]),_:1}),l(A,{elevation:"0"},{default:d(()=>[l(b,{class:"pa-0 fs-16 fw-700 mb-4"},{default:d(()=>[u(a(e.$t("all_addresses")),1)]),_:1}),t("div",null,[e.addressesLoaded&&e.getAddresses.length>0?(m(),C(D,{key:0,class:"row-cols-1 row-cols-sm-2 gutters-10"},{default:d(()=>[(m(!0),h(I,null,M(e.getAddresses,(o,E)=>(m(),C(p,{key:E},{default:d(()=>[t("div",se,[t("div",null,a(o.address),1),t("div",null,a(o.postal_code)+", "+a(o.city)+", "+a(o.state),1),t("div",null,a(o.country),1),t("div",null,a(o.phone),1),l(F,{"offset-y":"",left:""},{activator:d(({props:g})=>[l($,R({ref_for:!0},g,{class:"absolute-top-right",color:"transparent",elevation:"0",fab:"",small:""}),{default:d(()=>[...s[13]||(s[13]=[t("i",{class:"las la-ellipsis-v fs-18"},null,-1)])]),_:2},1040)]),default:d(()=>[l(L,{class:""},{default:d(()=>[l(_,{class:"c-pointer",onClick:g=>i.editAddress(o)},{default:d(()=>[l(w,null,{default:d(()=>[u(a(e.$t("edit")),1)]),_:1})]),_:2},1032,["onClick"]),l(_,{class:"c-pointer",onClick:g=>i.markDefaultShipping(o.id)},{default:d(()=>[l(w,null,{default:d(()=>[u(a(e.$t("mark_as_default_shipping_address")),1)]),_:1})]),_:2},1032,["onClick"]),l(_,{class:"c-pointer",onClick:g=>i.markDefaultBilling(o.id)},{default:d(()=>[l(w,null,{default:d(()=>[u(a(e.$t("mark_as_default_billing_address")),1)]),_:1})]),_:2},1032,["onClick"]),l(_,{class:"c-pointer",onClick:g=>i.deleteAddress(o.id)},{default:d(()=>[l(w,null,{default:d(()=>[u(a(e.$t("delete")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)])]),_:2},1024))),128))]),_:1})):(m(),h("div",ae,[t("div",null,a(e.$t("no_saved_address")),1)]))])]),_:1})]),_:1}),l(p,{cols:"auto"})]),_:1})])}const oe=N(G,[["render",te]]);export{oe as default};
