import{u as e,a as s,c as t,r as i,e as a,b as o,m as r,l,d as n,f as d,g as h,_ as m,h as p,o as c,i as u,j as g,w as _,k as f,t as v,n as w,F as y,p as $,q as b,s as S,v as P}from"./app-0e743bd7.js";const{verifyRecaptcha:x}=e(),k={data:()=>({mobileInputProps:{inputOptions:{type:"tel",placeholder:"phone number"},dropdownOptions:{showDialCodeInSelection:!1,showFlags:!0,showDialCodeInList:!0},autoDefaultCountry:!1,validCharactersOnly:!0,mode:"international"},showPhoneField:!1,v$:s(),form:{phone:"",email:"",password:"",invalidPhone:!0,showInvalidPhone:!1},passwordShow:!1,loading:!1}),components:{VueTelInput:t},validations:{form:{email:{requiredIf:i(function(){return"email"==this.authSettings.customer_login_with||"email_phone"==this.authSettings.customer_login_with&&!this.showPhoneField}),email:a},phone:{requiredIf:i(function(){return"phone"==this.authSettings.customer_login_with||"email_phone"==this.authSettings.customer_login_with&&this.showPhoneField})},password:{required:o}}},computed:{...r("app",["generalSettings","availableCountries","demoMode","banners"]),...r("cart",["getTempUserId"]),...r("auth",["authSettings","currentUser"]),emailErrors(){const e=[];return this.v$.form.email.$dirty?(!this.v$.form.email.requiredIf&&e.push(this.$i18n.t("this_field_is_required")),!this.v$.form.email.email&&e.push(this.$i18n.t("this_field_is_required_a_valid_email")),e):e},passwordErrors(){const e=[];return this.v$.form.password.$dirty?(!this.v$.form.password.required&&e.push(this.$i18n.t("this_field_is_required")),e):e}},async mounted(){if(this.generalSettings.google_recaptcha&&this.generalSettings.recaptcha_delivery_boy_login)try{await l(""),this.recaptchaReady=!0,console.log("reCAPTCHA ready!")}catch(e){console.error(e)}},beforeUnmount(){n()},methods:{...d("auth",{actionLogin:"login"}),...d("app",["fetchProductQuerries"]),...d("wishlist",["fetchWislistProducts"]),...d("cart",["fetchCartProducts"]),...h("cart",["removeTempUserId"]),...h("auth",["updateChatWindow","showLoginDialog"]),phoneValidate(e){this.form.invalidPhone=!e.valid,e.valid&&(this.form.showInvalidPhone=!1)},...d(["auth/logout"]),async login(){if(this.generalSettings.google_recaptcha&&this.generalSettings.recaptcha_delivery_boy_login){const e=await x("register-shop");if(!e.success)return void this.snack({message:e.message,color:"red"})}if(!(await this.v$.$validate()))return;if(("phone"==this.authSettings.customer_login_with||"email_phone"==this.authSettings.customer_login_with&&this.showPhoneField)&&this.form.invalidPhone)return void(this.form.showInvalidPhone=!0);this.getTempUserId&&(this.form.temp_user_id=this.getTempUserId),this.form.phone=this.form.phone.replace(/\s/g,""),this.form.form_type="delivery_boy",this.loading=!0;const e=await this.call_api("post","auth/login",this.form);e.data.success?(1==e.data.verified||"disabled"==this.authSettings.customer_otp_with?(this.getTempUserId&&this.removeTempUserId(),this.actionLogin(e.data),this.showLoginDialog(!1),this.updateChatWindow(!1),this.fetchWislistProducts(),this.fetchProductQuerries(),this.fetchCartProducts(),this.$router.push(this.$route.query.redirect||{name:"DeliveryBoyDashboard"})):"email"==this.authSettings.customer_login_with||"email_phone"==this.authSettings.customer_login_with&&"email"==this.authSettings.customer_otp_with?this.$router.push({name:"VerifyAccount",params:{email:this.form.email}}):this.$router.push({name:"VerifyAccount",params:{phone:this.form.phone}}),this.snack({message:e.data.message})):this.snack({message:e.data.message,color:"red"}),this.loading=!1}},created(){this.demoMode&&(this.form.email="deliveryboy@example.com",this.form.password="123456")}},I={class:"rounded-lg pa-5 border border-gray-200 overflow-hidden white shadow-light"},C={class:"px-lg-7"},V={class:"text-uppercase lh-1 mb-6"},F={class:"opacity-50 fs-22 fw-400"},q={class:"d-block display-1 fw-900 primary-text"},U={class:"opacity-50 fs-22 fw-400"},D={key:0,class:"mb-4"},T={class:"mb-1 fs-13 fw-500"},L={key:0,class:"text-end font-italic fs-12 opacity-70"},A={key:1,class:"mb-4"},E={class:"mb-1 fs-13 fw-500"},W={key:0,class:"v-text-field__details mt-2 pl-3"},O={class:"v-messages theme-light error-text",role:"alert"},j={class:"v-messages__wrapper"},z={class:"v-messages__message"},B={key:1,class:"v-text-field__details mt-2 pl-3"},M={class:"v-messages theme-light error-text",role:"alert"},Q={class:"v-messages__wrapper"},R={class:"v-messages__message"},H={key:2,class:"text-end font-italic fs-12 opacity-70"},N={class:"mb-1 fs-13 fw-500"};const G=m({components:{DeliveryBoyLoginForm:m(k,[["render",function(e,s,t,i,a,o){const r=p("banner"),l=p("v-col"),n=p("v-text-field"),d=p("vue-tel-input"),h=p("v-btn"),m=p("v-form"),x=p("v-row");return c(),u("div",I,[g(x,{"no-gutters":"",align:"center"},{default:_(()=>[g(l,{cols:"12",lg:"6",order:"2","order-lg":"1",class:""},{default:_(()=>[g(r,{loading:!1,banner:e.$store.getters["app/banners"].delivery_boy_login_page,class:"mt-5 mt-lg-0"},null,8,["banner"])]),_:1}),g(l,{cols:"12",order:"1","order-lg":"2",lg:"6"},{default:_(()=>[f("div",C,[f("h1",V,[f("span",F,v(e.$t("delivery_boy_login_page")),1),f("span",q,v(e.$store.getters["app/appName"]),1),f("span",U,v(e.$t("account")),1)]),g(m,{ref:"loginForm","lazy-validation":"",onSubmit:s[6]||(s[6]=w(e=>o.login(),["prevent"]))},{default:_(()=>["email"==e.authSettings.customer_login_with||!e.showPhoneField&&"email_phone"==e.authSettings.customer_login_with?(c(),u("div",D,[f("div",T,v(e.$t("email")),1),g(n,{modelValue:e.form.email,"onUpdate:modelValue":s[0]||(s[0]=s=>e.form.email=s),placeholder:e.$t("email_address"),type:"text","error-messages":o.emailErrors,"hide-details":"auto",required:"",variant:"plain",class:"text-field"},null,8,["modelValue","placeholder","error-messages"]),(c(!0),u(y,null,$(e.v$.form.email.$errors,e=>(c(),u("p",{key:e.$uid,class:"text-red"},v(e.$message),1))),128)),"email_phone"==e.authSettings.customer_login_with?(c(),u("div",L,[f("span",{class:"primary-text c-pointer",onClick:s[1]||(s[1]=s=>e.showPhoneField=!e.showPhoneField)},v(e.$t("use_phone_instead")),1)])):b("",!0)])):b("",!0),"phone"==e.authSettings.customer_login_with||e.showPhoneField&&"email_phone"==e.authSettings.customer_login_with?(c(),u("div",A,[f("div",E,v(e.$t("phone_number")),1),g(d,S({modelValue:e.form.phone,"onUpdate:modelValue":s[2]||(s[2]=s=>e.form.phone=s)},e.mobileInputProps,{"only-countries":e.availableCountries,onValidate:o.phoneValidate}),{"arrow-icon":_(()=>[...s[7]||(s[7]=[f("span",{class:"vti__dropdown-arrow"}," ▼",-1)])]),_:1},16,["modelValue","only-countries","onValidate"]),e.v$.form.phone.$error?(c(),u("div",W,[f("div",O,[f("div",j,[f("div",z,v(e.$t("this_field_is_required")),1)])])])):b("",!0),!e.v$.form.phone.$error&&e.form.showInvalidPhone?(c(),u("div",B,[f("div",M,[f("div",Q,[f("div",R,v(e.$t("phone_number_must_be_valid")),1)])])])):b("",!0),"email_phone"==e.authSettings.customer_login_with?(c(),u("div",H,[f("span",{class:"primary-text c-pointer",onClick:s[3]||(s[3]=s=>e.showPhoneField=!e.showPhoneField)},v(e.$t("use_phone_instead")),1)])):b("",!0)])):b("",!0),f("div",null,[f("div",N,v(e.$t("password")),1),g(n,{modelValue:e.form.password,"onUpdate:modelValue":s[4]||(s[4]=s=>e.form.password=s),placeholder:"* * * * * * * *","error-messages":o.passwordErrors,type:e.passwordShow?"text":"password","append-icon":e.passwordShow?"las la-eye":"las la-eye-slash",class:"input-group-focused text-field","hide-details":"auto",required:"",variant:"plain","onClick:append":s[5]||(s[5]=s=>e.passwordShow=!e.passwordShow)},null,8,["modelValue","error-messages","type","append-icon"]),(c(!0),u(y,null,$(e.v$.form.password.$errors,e=>(c(),u("p",{key:e.$uid,class:"text-red"},v(e.$message),1))),128))]),g(h,{style:{color:"#fff !important"},size:"x-large",class:"px-16 mb-4 mt-2",elevation:"0",type:"submit",color:"primary",loading:e.loading,disabled:e.loading,onClick:o.login},{default:_(()=>[P(v(e.$t("login")),1)]),_:1},8,["loading","disabled","onClick"])]),_:1},512)])]),_:1})]),_:1})])}]])}},[["render",function(e,s,t,i,a,o){const r=p("delivery-boy-login-form"),l=p("v-col"),n=p("v-row"),d=p("v-container");return c(),u("div",null,[g(d,null,{default:_(()=>[g(n,null,{default:_(()=>[g(l,{xl:"10",class:"mx-auto my-5 my-lg-16"},{default:_(()=>[g(r)]),_:1})]),_:1})]),_:1})])}]]);export{G as default};
