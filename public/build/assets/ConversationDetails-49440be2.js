import{_ as s,a as e,b as a,h as t,o as i,i as r,k as o,t as l,j as n,w as d,F as c,p as m,A as v,n as g,v as u}from"./app-0e743bd7.js";const h={class:"ps-lg-7 pt-4"},p={class:"fs-24 fw-700 opacity-80 mb-5 mt-3"},f={key:0},_={class:"text-center"},$={key:1},w={class:"px-3 py-3 mb-3 border-bottom"},b={class:"col-sm-12 pb-0 pb-md-2"},y={class:"d-flex align-center"},x=["src"],k={class:"ml-3"},q={class:"col-sm-12"},D={class:"d-flex align-center"},V={class:"mb-3"},j={class:"mb-1 fs-13 fw-500"},z={class:"text-right mt-4"};const E=s({data:()=>({loading:!0,sending:!1,conversation:null,v$:e(),form:{message:"",conversation_id:null}}),created(){this.getDetails(this.$route.params.slug),window.intervalCall=setInterval(()=>{this.getDetails(this.$route.params.slug)},5e3)},validations:{form:{message:{required:a}}},computed:{messageErrors(){const s=[];return this.v$.form.message.$dirty?(!this.v$.form.message.required&&s.push(this.$i18n.t("this_field_is_required")),s):s}},methods:{async getDetails(s){const e=await this.call_api("get",`user/querries/${s}`);e.data.success?(this.conversation=e.data.data,this.form.conversation_id=e.data.data.id,this.loading=!1):this.snack({message:e.data.message,color:"red"})},async addNewMessage(){if(!(await this.v$.$validate()))return;this.sending=!0;const s=await this.call_api("post","user/new-message-query",this.form);s.data.success?(this.conversation=s.data.data,this.snack({message:s.data.message}),this.resetData()):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"}),this.sending=!1},resetData(){this.form.message="",this.form.conversation_id=this.conversation.id,this.v$.form.$reset()}}},[["render",function(s,e,a,E,F,M){const N=t("v-avatar"),A=t("v-textarea"),B=t("v-btn"),C=t("v-form"),I=t("v-card");return i(),r("div",h,[o("h1",p,l(s.$t("query_with"))+" "+l(s.conversation&&s.conversation.receiver_shop),1),s.loading?(i(),r("div",f,[o("div",_,[o("div",null,l(s.$t("loading_please_wait")),1)])])):(i(),r("div",$,[n(I,null,{default:d(()=>[o("h4",w," #"+l(s.conversation.title)+" ( Between you & "+l(s.conversation.receiver_shop)+" ) ",1),(i(!0),r(c,null,m(s.conversation.messages,(a,t)=>(i(),r("div",{key:t,class:v(["row mx-4 align-center py-2",{"border-bottom":t+1!=s.conversation.messages.length}])},[o("div",b,[o("div",y,[n(N,{size:"60"},{default:d(()=>[o("img",{src:a.user_image,class:"border border-4",onError:e[0]||(e[0]=e=>s.imageFallback(e))},null,40,x)]),_:2},1024),o("div",k,[o("h5",null,l(a.user_name),1),o("div",null,l(a.created_at),1)])])]),o("div",q,[o("div",D,[o("div",null,[o("div",null,l(a.message),1)])])])],2))),128)),n(C,{"lazy-validation":"",autocomplete:"chrome-off",class:"px-3 py-5",onSubmit:e[2]||(e[2]=g(s=>M.addNewMessage(),["prevent"]))},{default:d(()=>[o("div",V,[o("div",j,l(s.$t("message")),1),n(A,{modelValue:s.form.message,"onUpdate:modelValue":e[1]||(e[1]=e=>s.form.message=e),placeholder:s.$t("message"),"hide-details":"auto",rows:"4",required:"",variant:"outlined"},null,8,["modelValue","placeholder"]),(i(!0),r(c,null,m(s.v$.form.message.$errors,s=>(i(),r("p",{key:s.$uid,class:"text-red"},l(s.$message),1))),128))]),o("div",z,[n(B,{elevation:"0",type:"submit",color:"primary",loading:s.sending},{default:d(()=>[u(l(s.$t("send")),1)]),_:1},8,["loading"])])]),_:1})]),_:1})]))])}]]);export{E as default};
