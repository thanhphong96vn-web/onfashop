import{_ as b,a as S,c as C,r as m,e as $,b as P,m as p,f as r,g as k,h as i,o as h,i as d,j as o,w as a,k as n,t as s,q as I,n as V,v as _}from"./app-65cf1f07.js";const L={data:()=>({mobileInputProps:{inputOptions:{type:"tel",placeholder:"phone number"},dropdownOptions:{showDialCodeInSelection:!1,showFlags:!0,showDialCodeInList:!0},autoDefaultCountry:!1,validCharactersOnly:!0,mode:"international"},v$:S(),form:{email:"",phone:"",code:"",invalidPhone:!0,showInvalidPhone:!1},loading:!1,resendLoading:!1}),components:{VueTelInput:C},validations:{form:{email:{requiredIf:m(function(){return this.authSettings.customer_login_with=="email"||this.authSettings.customer_login_with=="email_phone"&&this.authSettings.customer_otp_with=="email"}),email:$},phone:{requiredIf:m(function(){return this.authSettings.customer_login_with=="phone"||this.authSettings.customer_login_with=="email_phone"&&this.authSettings.customer_otp_with=="phone"})},code:{required:P}}},computed:{...p("auth",["authSettings"]),...p("app",["availableCountries"])},methods:{...r("auth",{actionLogin:"login"}),...k("auth",["updateChatWindow","showLoginDialog"]),...r("app",["fetchProductQuerries"]),...r("wishlist",["fetchWislistProducts"]),...r("cart",["fetchCartProducts"]),phoneValidate(e){this.form.invalidPhone=!e.valid,e.valid&&(this.form.showInvalidPhone=!1)},async verifyAccount(){if(!await this.v$.$validate())return;if((this.authSettings.customer_login_with=="phone"||this.authSettings.customer_login_with=="email_phone"&&this.authSettings.customer_otp_with=="phone")&&this.form.invalidPhone){this.form.showInvalidPhone=!0;return}this.form.phone=this.form.phone.replace(/\s/g,""),this.loading=!0;const t=await this.call_api("post","auth/verify",this.form);t.data.success?(this.actionLogin(t.data),this.showLoginDialog(!1),this.updateChatWindow(!1),this.fetchWislistProducts(),this.fetchProductQuerries(),this.fetchCartProducts(),this.$router.push(this.$route.query.redirect||{name:"DashBoard"})):this.snack({message:t.data.message,color:"red"}),this.loading=!1},async resendCode(){if(this.v$.form.email.$touch(),this.v$.form.email.$anyError)return;if((this.authSettings.customer_login_with=="phone"||this.authSettings.customer_login_with=="email_phone"&&this.authSettings.customer_otp_with=="phone")&&this.form.invalidPhone){this.form.showInvalidPhone=!0;return}this.form.phone=this.form.phone.replace(/\s/g,""),this.resendLoading=!0;const e=await this.call_api("post","auth/resend-code",this.form);e.data.success?this.snack({message:e.data.message}):this.snack({message:e.data.message,color:"red"}),this.resendLoading=!1}},created(){this.form.email=this.$route.params.user,this.form.phone=this.$route.params.user}},q={class:"my-5 my-lg-16 rounded-lg pa-5 border overflow-hidden shadow-light"},D={key:0,class:"text-info mb-3"},A={key:1,class:"text-info mb-3"},B={class:"text-uppercase lh-1 mb-4 d-flex"},F={class:"display-1 text-primary fw-00"},N={class:"d-block display-1 fw-900 grey--text text--darken-3 ml-2"},W={class:"mb-4"},z={class:"mb-1 fs-13 fw-500"};function E(e,t,O,M,Q,l){const f=i("v-otp-input"),u=i("v-btn"),g=i("v-form"),v=i("v-col"),w=i("v-row"),y=i("v-container");return h(),d("div",null,[o(y,null,{default:a(()=>[o(w,null,{default:a(()=>[o(v,{cols:"12",lg:"6",md:"8",sm:"10",class:"mx-auto"},{default:a(()=>[n("div",q,[e.authSettings.customer_login_with=="email"||e.authSettings.customer_login_with=="email_phone"&&e.authSettings.customer_otp_with=="email"?(h(),d("div",D,s(e.$t("a_verification_code_has_been_sent_to_your_email")),1)):e.authSettings.customer_login_with=="phone"||e.authSettings.customer_login_with=="email_phone"&&e.authSettings.customer_otp_with=="phone"?(h(),d("div",A,s(e.$t("a_verification_code_has_been_sent_to_your_phone_number")),1)):I("",!0),n("h1",B,[n("span",F,s(e.$t("verify")),1),n("span",N,s(e.$t("account")),1)]),o(g,{ref:"loginForm","lazy-validation":"",onSubmit:t[1]||(t[1]=V(c=>l.verifyAccount(),["prevent"]))},{default:a(()=>[n("div",W,[n("div",z,s(e.$t("enter_your_verification_code")),1),o(f,{modelValue:e.form.code,"onUpdate:modelValue":t[0]||(t[0]=c=>e.form.code=c),length:"6",type:"number","error-messages":e.codeErrors,"hide-details":"auto",disabled:e.loading,required:""},null,8,["modelValue","error-messages","disabled"])]),o(u,{size:"x-large",class:"px-12 mb-4 btn-primary",elevation:"0",type:"submit",loading:e.loading,disabled:e.loading,onClick:l.verifyAccount},{default:a(()=>[_(s(e.$t("verify")),1)]),_:1},8,["loading","disabled","onClick"]),o(u,{size:"x-large",class:"px-12 mb-4 ms-3",elevation:"0",type:"button",color:"grey-lighten-4",loading:e.resendLoading,disabled:e.resendLoading,onClick:l.resendCode},{default:a(()=>[_(s(e.$t("resend_code")),1)]),_:1},8,["loading","disabled","onClick"])]),_:1},512)])]),_:1})]),_:1})]),_:1})])}const j=b(L,[["render",E]]);export{j as default};
